<style>
    .timeline-page {
        max-width: 100%;
        margin: 0 auto;
        padding: 2rem;
        overflow-x: hidden;
    }

    .page-header {
        text-align: center;
        margin-bottom: 2rem;
    }

    .page-header h1 {
        font-size: 2.5rem;
        color: #8b0000;
        font-family: 'Playfair Display', serif;
        margin-bottom: 0.5rem;
    }

    .page-header p {
        color: #666;
        font-size: 1.1rem;
    }

    /* Map Section */
    .map-section {
        background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        color: white;
        padding: 1.5rem;
        border-radius: 20px 20px 0 0;
        text-align: center;
    }

    .map-container {
        height: 350px;
        background: white;
        border-radius: 0 0 20px 20px;
        overflow: hidden;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        margin-bottom: 3rem;
    }

    /* Horizontal Timeline */
    .horizontal-timeline-section {
        margin-top: 2rem;
    }

    .timeline-nav {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .timeline-nav-btn {
        background: white;
        border: 2px solid #8b0000;
        color: #8b0000;
        padding: 0.8rem 2rem;
        border-radius: 50px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
    }

    .timeline-nav-btn:hover {
        background: #8b0000;
        color: white;
    }

    .timeline-nav-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    /* Year Pills */
    .year-pills {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
    }

    .year-pill {
        background: #f0f0f0;
        border: none;
        padding: 0.5rem 1.2rem;
        border-radius: 50px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 1rem;
    }

    .year-pill:hover,
    .year-pill.active {
        background: #8b0000;
        color: white;
    }

    /* Horizontal Scroll Container */
    .timeline-scroll-wrapper {
        position: relative;
        padding: 2rem 0;
    }

    .timeline-scroll-container {
        overflow-x: auto;
        padding: 2rem 1rem;
        scrollbar-width: thin;
        scrollbar-color: #8b0000 #f0f0f0;
        scroll-behavior: smooth;
    }

    .timeline-scroll-container::-webkit-scrollbar {
        height: 10px;
    }

    .timeline-scroll-container::-webkit-scrollbar-track {
        background: #f0f0f0;
        border-radius: 10px;
    }

    .timeline-scroll-container::-webkit-scrollbar-thumb {
        background: #8b0000;
        border-radius: 10px;
    }

    /* Horizontal Line */
    .timeline-horizontal {
        display: flex;
        align-items: flex-start;
        position: relative;
        padding-top: 60px;
        min-width: max-content;
    }

    .timeline-horizontal::before {
        content: '';
        position: absolute;
        top: 78px;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(90deg, #8b0000, #d97706, #16a34a, #2563eb, #8b0000);
        border-radius: 3px;
    }

    /* Timeline Card */
    .h-tl-item {
        flex: 0 0 320px;
        margin: 0 1rem;
        position: relative;
    }

    .h-tl-marker {
        position: absolute;
        top: -42px;
        left: 50%;
        transform: translateX(-50%);
        width: 50px;
        height: 50px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        z-index: 10;
        transition: all 0.3s;
    }

    .h-tl-item:hover .h-tl-marker {
        transform: translateX(-50%) scale(1.1);
    }

    .h-tl-marker.askeri {
        border: 4px solid #dc2626;
        color: #dc2626;
    }

    .h-tl-marker.zafer {
        border: 4px solid #16a34a;
        color: #16a34a;
    }

    .h-tl-marker.siyasi {
        border: 4px solid #2563eb;
        color: #2563eb;
    }

    .h-tl-marker.toplumsal {
        border: 4px solid #d97706;
        color: #d97706;
    }

    .h-tl-marker.matem {
        border: 4px solid #1e293b;
        color: #1e293b;
    }

    .h-tl-marker.basyazi {
        border: 4px solid #7c3aed;
        color: #7c3aed;
    }

    .h-tl-marker.devrim {
        border: 4px solid #ec4899;
        color: #ec4899;
    }

    .h-tl-date {
        position: absolute;
        top: -75px;
        left: 50%;
        transform: translateX(-50%);
        background: #8b0000;
        color: white;
        padding: 0.3rem 0.8rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 700;
        white-space: nowrap;
    }

    .h-tl-card {
        background: white;
        border-radius: 20px;
        padding: 1.5rem;
        margin-top: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
        cursor: pointer;
        height: 280px;
        display: flex;
        flex-direction: column;
    }

    .h-tl-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
    }

    .h-tl-card.askeri {
        border-top: 5px solid #dc2626;
    }

    .h-tl-card.zafer {
        border-top: 5px solid #16a34a;
    }

    .h-tl-card.siyasi {
        border-top: 5px solid #2563eb;
    }

    .h-tl-card.toplumsal {
        border-top: 5px solid #d97706;
    }

    .h-tl-card.matem {
        border-top: 5px solid #1e293b;
    }

    .h-tl-card.basyazi {
        border-top: 5px solid #7c3aed;
    }

    .h-tl-card.devrim {
        border-top: 5px solid #ec4899;
    }

    .h-tl-title {
        font-size: 1.1rem;
        font-weight: 700;
        font-family: 'Playfair Display', serif;
        color: #1e293b;
        margin-bottom: 0.75rem;
        line-height: 1.3;
    }

    .h-tl-content {
        font-size: 0.9rem;
        color: #555;
        line-height: 1.6;
        flex: 1;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 5;
        -webkit-box-orient: vertical;
    }

    .h-tl-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: auto;
        padding-top: 1rem;
        border-top: 1px dashed #ddd;
    }

    .h-tl-category {
        font-size: 0.7rem;
        font-weight: 700;
        padding: 0.2rem 0.6rem;
        border-radius: 20px;
        text-transform: uppercase;
    }

    .h-tl-category.askeri {
        background: #fee2e2;
        color: #dc2626;
    }

    .h-tl-category.zafer {
        background: #dcfce7;
        color: #16a34a;
    }

    .h-tl-category.siyasi {
        background: #dbeafe;
        color: #2563eb;
    }

    .h-tl-category.toplumsal {
        background: #fef3c7;
        color: #d97706;
    }

    .h-tl-category.matem {
        background: #e2e8f0;
        color: #1e293b;
    }

    .h-tl-category.basyazi {
        background: #ede9fe;
        color: #7c3aed;
    }

    .h-tl-category.devrim {
        background: #fce7f3;
        color: #ec4899;
    }

    .h-tl-location {
        font-size: 0.75rem;
        color: #888;
    }

    /* Legend */
    .timeline-legend {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        justify-content: center;
        margin-bottom: 1.5rem;
        padding: 1rem;
        background: #f8f9fa;
        border-radius: 15px;
    }

    .legend-item {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        font-size: 0.85rem;
        font-weight: 600;
    }

    .legend-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
    }

    .legend-dot.askeri {
        background: #dc2626;
    }

    .legend-dot.zafer {
        background: #16a34a;
    }

    .legend-dot.siyasi {
        background: #2563eb;
    }

    .legend-dot.toplumsal {
        background: #d97706;
    }

    .legend-dot.matem {
        background: #1e293b;
    }

    .legend-dot.basyazi {
        background: #7c3aed;
    }

    .legend-dot.devrim {
        background: #ec4899;
    }

    /* Scroll Hint */
    .scroll-hint {
        text-align: center;
        color: #888;
        font-size: 0.9rem;
        margin-bottom: 1rem;
    }

    .scroll-hint i {
        animation: bounceX 1.5s infinite;
    }

    @keyframes bounceX {

        0%,
        100% {
            transform: translateX(0);
        }

        50% {
            transform: translateX(10px);
        }
    }

    /* Leaflet Popup */
    .leaflet-popup-content-wrapper {
        background: #fffaf0;
        border-radius: 4px;
        box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3);
        border: 2px solid #8b0000;
    }

    .vintage-popup {
        padding: 0.8rem;
    }

    .popup-location {
        font-family: 'Playfair Display', serif;
        font-size: 1rem;
        color: #8b0000;
        font-weight: 700;
    }

    @media (max-width: 768px) {
        .h-tl-item {
            flex: 0 0 280px;
        }

        .h-tl-card {
            height: 260px;
        }

        .timeline-nav {
            flex-direction: column;
            align-items: center;
        }
    }
</style>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<div class="timeline-page">
    <div class="page-header">
        <h1>üìú Milli M√ºcadele Zaman √áizelgesi</h1>
        <p>1918 - 1923 | ƒ∞stikbal Gazetesi Haber Ar≈üivi</p>
    </div>

    <!-- Map Section -->
    <div class="map-section">
        <i class="fas fa-map-marked-alt" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
        <h2 style="font-size: 1.3rem; margin: 0;">Haber Haritasƒ±</h2>
    </div>
    <div class="map-container" id="map"></div>

    <!-- Horizontal Timeline -->
    <div class="horizontal-timeline-section">
        <div class="timeline-legend">
            <div class="legend-item">
                <div class="legend-dot askeri"></div> Askeri
            </div>
            <div class="legend-item">
                <div class="legend-dot zafer"></div> Zafer
            </div>
            <div class="legend-item">
                <div class="legend-dot siyasi"></div> Siyasi
            </div>
            <div class="legend-item">
                <div class="legend-dot toplumsal"></div> Toplumsal
            </div>
            <div class="legend-item">
                <div class="legend-dot matem"></div> Matem
            </div>
            <div class="legend-item">
                <div class="legend-dot basyazi"></div> Ba≈üyazƒ±
            </div>
            <div class="legend-item">
                <div class="legend-dot devrim"></div> Devrim
            </div>
        </div>

        <div class="year-pills" id="year-pills">
            <!-- Year pills will be added by JS -->
        </div>

        <div class="scroll-hint">
            <i class="fas fa-arrows-alt-h"></i> Kaydƒ±rarak gezin veya yƒ±l butonlarƒ±na tƒ±klayƒ±n
        </div>

        <div class="timeline-nav">
            <button class="timeline-nav-btn" onclick="scrollTimeline(-400)">
                <i class="fas fa-chevron-left"></i> √ñnceki
            </button>
            <button class="timeline-nav-btn" onclick="scrollTimeline(400)">
                Sonraki <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <div class="timeline-scroll-wrapper">
            <div class="timeline-scroll-container" id="timeline-scroll">
                <div class="timeline-horizontal" id="timeline-horizontal">
                    <!-- Items will be added by JS -->
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    (async function () {
        // Initialize Map
        const map = L.map('map').setView([39.5, 35.0], 6);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // Load News Data
        try {
            const response = await fetch('../data/news.json');
            const data = await response.json();
            const newsList = data.archive;

            // Add markers to map
            newsList.forEach(news => {
                const marker = L.marker([news.lat, news.lng]).addTo(map);
                marker.bindPopup(`
                <div class="vintage-popup">
                    <div class="popup-location">${news.location}</div>
                    <div style="font-size: 0.8rem; color: #555;">${news.date}</div>
                    <div style="font-weight: 700; margin-top: 0.5rem;">${news.title}</div>
                </div>
            `);
            });

            // Helper functions
            function extractYear(dateStr) {
                const match = dateStr.match(/(\d{4})/);
                return match ? parseInt(match[1]) : 1920;
            }

            function getIcon(category) {
                const icons = {
                    'ASKERƒ∞': 'fa-shield-alt',
                    'ZAFER': 'fa-trophy',
                    'Sƒ∞YASƒ∞': 'fa-landmark',
                    'TOPLUMSAL': 'fa-users',
                    'MATEM': 'fa-fist-raised',
                    'BA≈ûYAZI': 'fa-pen-fancy',
                    'DEVRƒ∞M': 'fa-star'
                };
                return icons[category] || 'fa-newspaper';
            }

            function getCategoryClass(category) {
                const classes = {
                    'ASKERƒ∞': 'askeri',
                    'ZAFER': 'zafer',
                    'Sƒ∞YASƒ∞': 'siyasi',
                    'TOPLUMSAL': 'toplumsal',
                    'MATEM': 'matem',
                    'BA≈ûYAZI': 'basyazi',
                    'DEVRƒ∞M': 'devrim'
                };
                return classes[category] || 'askeri';
            }

            // Sort by date
            const sortedNews = [...newsList].sort((a, b) => {
                return extractYear(a.date) - extractYear(b.date) || a.id - b.id;
            });

            // Get unique years
            const years = [...new Set(sortedNews.map(n => extractYear(n.date)))].sort();

            // Create year pills
            const yearPillsContainer = document.getElementById('year-pills');
            years.forEach((year, idx) => {
                const pill = document.createElement('button');
                pill.className = 'year-pill' + (idx === 0 ? ' active' : '');
                pill.textContent = year;
                pill.onclick = () => scrollToYear(year);
                yearPillsContainer.appendChild(pill);
            });

            // Render horizontal timeline
            const container = document.getElementById('timeline-horizontal');

            sortedNews.forEach((news, index) => {
                const catClass = getCategoryClass(news.category);
                const year = extractYear(news.date);

                const html = `
                <div class="h-tl-item" data-year="${year}" data-index="${index}">
                    <div class="h-tl-date">${news.date}</div>
                    <div class="h-tl-marker ${catClass}">
                        <i class="fas ${getIcon(news.category)}"></i>
                    </div>
                    <div class="h-tl-card ${catClass}" onclick="showDetail(${news.id})">
                        <div class="h-tl-title">${news.title}</div>
                        <div class="h-tl-content">${news.content}</div>
                        <div class="h-tl-meta">
                            <span class="h-tl-category ${catClass}">${news.category}</span>
                            <span class="h-tl-location"><i class="fas fa-map-marker-alt"></i> ${news.location}</span>
                        </div>
                    </div>
                </div>
            `;
                container.innerHTML += html;
            });

            // Store news data globally
            window.newsData = sortedNews;

        } catch (error) {
            console.error('Timeline error:', error);
            document.getElementById('timeline-horizontal').innerHTML = `
            <div style="padding: 3rem; text-align: center; color: #888;">
                <i class="fas fa-exclamation-triangle" style="font-size: 2rem;"></i>
                <p>Zaman √ßizelgesi y√ºklenirken hata olu≈ütu.</p>
            </div>
        `;
        }
    })();

    // Scroll timeline left/right
    function scrollTimeline(amount) {
        const container = document.getElementById('timeline-scroll');
        container.scrollBy({ left: amount, behavior: 'smooth' });
    }

    // Scroll to specific year
    function scrollToYear(year) {
        const item = document.querySelector(`.h-tl-item[data-year="${year}"]`);
        if (item) {
            const container = document.getElementById('timeline-scroll');
            const itemLeft = item.offsetLeft - 50;
            container.scrollTo({ left: itemLeft, behavior: 'smooth' });

            // Update active pill
            document.querySelectorAll('.year-pill').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.year-pill').forEach(p => {
                if (p.textContent == year) p.classList.add('active');
            });
        }
    }

    // Show detail (can be extended to show modal)
    function showDetail(id) {
        const news = window.newsData?.find(n => n.id === id);
        if (news) {
            alert(`${news.title}\n\n${news.content}\n\nüìç ${news.location} | üìÖ ${news.date}`);
        }
    }
</script>